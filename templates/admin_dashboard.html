<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard - Student Skill Analyzer</title>

    <!-- ‚úÖ Bootstrap CSS (for layout & styling) -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    >

    <!-- ‚úÖ Chart.js (for charts) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body {
            background-color: #0b1020;
            color: #f5f5f5;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }

        .sidebar {
            height: 100vh;
            background: #111729;
            padding: 20px;
        }

        .sidebar a {
            color: #c3c6d8;
            display: block;
            padding: 10px 0;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .sidebar a.active,
        .sidebar a:hover {
            color: #00f5a0;
        }

        .card {
            background: #111729;
            border: 1px solid #1e263d;
        }

        .card-title {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05rem;
            color: #9aa0b8;
        }

        .card-value {
            font-size: 1.6rem;
            font-weight: 600;
        }

        .chart-container {
            background: #111729;
            border-radius: 8px;
            padding: 16px;
            border: 1px solid #1e263d;
        }

        .brand-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #00f5a0;
        }

        .brand-subtitle {
            font-size: 0.8rem;
            color: #9aa0b8;
        }
    </style>
</head>
<body>
<div class="container-fluid">
    <div class="row">

        <!-- ‚úÖ LEFT SIDEBAR -->
        <div class="col-md-2 sidebar">
            <div class="mb-4">
                <div class="brand-title">Skillify Admin</div>
                <div class="brand-subtitle">Student Skill Analyzer</div>
            </div>

            <a href="/admin/dashboard" class="active">üìä Dashboard</a>
            <a href="/admin/students">üë®‚Äçüéì Students</a>
            <a href="/admin/quizzes">üìù Quizzes</a>
            <a href="/admin/skills">üß† Skill Insights</a>
            <a href="/admin/learning-paths">üß≠ Learning Paths</a>
            <a href="/logout">üö™ Logout</a>
        </div>

        <!-- ‚úÖ MAIN CONTENT -->
        <div class="col-md-10 p-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="mb-0">Admin Dashboard</h2>
                <span class="badge bg-success">Logged in as Admin</span>
            </div>

            <!-- ‚úÖ TOP SUMMARY CARDS -->
            <div class="row g-3 mb-4">
                <div class="col-md-3">
                    <div class="card p-3">
                        <div class="card-title">Total Students</div>
                        <div class="card-value">{{ stats.total_students }}</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card p-3">
                        <div class="card-title">Total Quizzes</div>
                        <div class="card-value">{{ stats.total_quizzes }}</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card p-3">
                        <div class="card-title">Average Score</div>
                        <div class="card-value">{{ stats.avg_score }}%</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card p-3">
                        <div class="card-title">Active Users</div>
                        <div class="card-value">{{ stats.active_users }}</div>
                    </div>
                </div>
            </div>

            <!-- ‚úÖ CHARTS ROW -->
            <div class="row g-3">
                <div class="col-md-6">
                    <div class="chart-container">
                        <h6 class="mb-3">Students per Branch</h6>
                        <canvas id="studentsPerBranchChart"></canvas>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="chart-container">
                        <h6 class="mb-3">Average Score per Branch</h6>
                        <canvas id="avgScorePerBranchChart"></canvas>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<!-- ‚úÖ JS: Pass Python Data to JavaScript & Render Charts -->
<script>
    // 1Ô∏è‚É£ Data from Flask (Jinja ‚Üí JS)
    const branches = {{ stats.branches | tojson }};
    const studentsPerBranch = {{ stats.students_per_branch | tojson }};
    const avgScorePerBranch = {{ stats.avg_score_per_branch | tojson }};

    // 2Ô∏è‚É£ Students per Branch ‚Äì Bar Chart
    const ctx1 = document.getElementById('studentsPerBranchChart').getContext('2d');
    new Chart(ctx1, {
        type: 'bar',
        data: {
            labels: branches,
            datasets: [{
                label: 'Students',
                data: studentsPerBranch,
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { display: false }
            },
            scales: {
                x: { ticks: { color: '#c3c6d8' } },
                y: { ticks: { color: '#c3c6d8' } }
            }
        }
    });

    // 3Ô∏è‚É£ Average Score per Branch ‚Äì Line Chart
    const ctx2 = document.getElementById('avgScorePerBranchChart').getContext('2d');
    new Chart(ctx2, {
        type: 'line',
        data: {
            labels: branches,
            datasets: [{
                label: 'Average Score (%)',
                data: avgScorePerBranch,
                tension: 0.3,
                borderWidth: 2
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { display: false }
            },
            scales: {
                x: { ticks: { color: '#c3c6d8' } },
                y: { ticks: { color: '#c3c6d8' } }
            }
        }
    });
    {% if session.get('role') == 'admin' %}
    <a href="/admin/dashboard" class="btn btn-warning">Admin Dashboard</a>
    {% endif %}

</script>

</body>
</html>
